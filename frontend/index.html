<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Interview Reviewer</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <h1><i class="fas fa-comments"></i> Advanced Interview Reviewer</h1>
                <div class="api-status">
                    <span id="apiStatus">Checking connection...</span>
                </div>
            </div>
            <p class="subtitle">Manage questions, answers, and practice sessions by company & role</p>
        </header>

        <div class="tabs" id="tabs">
            <button class="tab-button active" data-tab="questions">Questions</button>
            <button class="tab-button" data-tab="answers">Answers</button>
            <button class="tab-button" data-tab="categories">Categories</button>
            <button class="tab-button" data-tab="companies">Companies</button>
            <button class="tab-button" data-tab="roles">Roles</button>
            <button class="tab-button" data-tab="sessions">Practice Sessions</button>
        </div>

        <main class="tab-content">
            <!-- Questions Tab -->
            <div id="questions-tab" class="tab-pane active">
                <div class="tab-header">
                    <h2><i class="fas fa-question-circle"></i> Questions Management</h2>
                    <button class="btn btn-primary" onclick="showQuestionModal()">
                        <i class="fas fa-plus"></i> Add Question
                    </button>
                </div>
                <div class="questions-list" id="questionsList">
                    <!-- Questions will be loaded here -->
                </div>
            </div>

            <!-- Answers Tab -->
            <div id="answers-tab" class="tab-pane">
                <div class="tab-header">
                    <h2><i class="fas fa-comment-dots"></i> Answers Management</h2>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <div id="currentQuestionTitle" style="font-size: 1rem; color: #64748b; flex-grow: 1;">
                            Select a question to view or add answers
                        </div>
                        <button class="btn btn-primary" onclick="showAnswerModal()" id="addAnswerBtn" disabled>
                            <i class="fas fa-plus"></i> Add Answer
                        </button>
                    </div>
                </div>
                
                <!-- Questions sidebar for Answers tab -->
                <div class="answers-container">
                    <div class="questions-sidebar" id="questionsForAnswers">
                        <!-- Questions list will be loaded here -->
                    </div>
                    
                    <div class="answers-main">
                        <div class="answers-list" id="answersList">
                            <div class="empty-state">
                                <i class="fas fa-comment-slash fa-2x"></i>
                                <p>Select a question to view answers</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Categories Tab -->
            <div id="categories-tab" class="tab-pane">
                <div class="tab-header">
                    <h2><i class="fas fa-tags"></i> Categories Management</h2>
                    <button class="btn btn-primary" onclick="showCategoryModal()">
                        <i class="fas fa-plus"></i> Add Category
                    </button>
                </div>
                <div class="categories-list" id="categoriesList">
                    <!-- Categories will be loaded here -->
                </div>
            </div>

            <!-- Companies Tab -->
            <div id="companies-tab" class="tab-pane">
                <div class="tab-header">
                    <h2><i class="fas fa-building"></i> Companies Management</h2>
                    <button class="btn btn-primary" onclick="showCompanyModal()">
                        <i class="fas fa-plus"></i> Add Company
                    </button>
                </div>
                <div class="companies-list" id="companiesList">
                    <!-- Companies will be loaded here -->
                </div>
            </div>

            <!-- Roles Tab -->
            <div id="roles-tab" class="tab-pane">
                <div class="tab-header">
                    <h2><i class="fas fa-briefcase"></i> Roles Management</h2>
                    <button class="btn btn-primary" onclick="showRoleModal()">
                        <i class="fas fa-plus"></i> Add Role
                    </button>
                </div>
                <div class="roles-list" id="rolesList">
                    <!-- Roles will be loaded here -->
                </div>
            </div>

            <!-- Practice Sessions Tab -->
            <div id="sessions-tab" class="tab-pane">
                <div class="tab-header">
                    <h2><i class="fas fa-play-circle"></i> Practice Sessions</h2>
                    <button class="btn btn-primary" onclick="showSessionModal()">
                        <i class="fas fa-plus"></i> Create Session
                    </button>
                </div>

                <div class="sessions-container">
                    <div class="sessions-list" id="sessionsList">
                        <!-- Sessions will be loaded here -->
                    </div>
                    
                    <div class="session-details" id="sessionDetails">
                        <div class="empty-state">
                            <i class="fas fa-hand-pointer fa-2x"></i>
                            <p>Select a session to view details and add questions</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>Advanced Interview Reviewer &copy; 2024 | Practice with Confidence</p>
        </footer>
    </div>

    <!-- Session Selection Modal -->
<div id="sessionSelectModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('sessionSelectModal')">&times;</span>
        <h3>Select a Session</h3>
        <p>Choose a session to add the question to:</p>
        
        <div class="sessions-selection-list" id="sessionsSelectionList" style="max-height: 300px; overflow-y: auto; margin: 20px 0;">
            <!-- Sessions will be loaded here -->
        </div>
        
        <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="closeModal('sessionSelectModal')">Cancel</button>
            <button type="button" class="btn btn-primary" onclick="createNewSessionForQuestion()">
                <i class="fas fa-plus"></i> Create New Session
            </button>
        </div>
    </div>
</div>
    
    
    <!-- Question Modal with Batch Mode -->
<div id="questionModal" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <span class="close" onclick="closeModal('questionModal')">&times;</span>
        <h3 id="questionModalTitle">Add New Question</h3>
        
        <!-- Mode Toggle -->
        <div class="mode-toggle" style="margin-bottom: 20px;">
            <button type="button" id="singleModeBtn" class="mode-btn active" onclick="setQuestionMode('single')">
                <i class="fas fa-file-alt"></i> Single Question
            </button>
            <button type="button" id="batchModeBtn" class="mode-btn" onclick="setQuestionMode('batch')">
                <i class="fas fa-list"></i> Batch Add (Multiple)
            </button>
        </div>
        
        <form id="questionForm">
            <input type="hidden" id="questionId">
            <input type="hidden" id="questionMode" value="single">
            
            <!-- Common Fields (Category, Company, Role) -->
            <div class="form-row">
                <div class="form-group">
                    <label for="categorySelect">Category *</label>
                    <select id="categorySelect" required>
                        <option value="">Select Category</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="companySelect">Company</label>
                    <select id="companySelect">
                        <option value="">Select Company</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="roleSelect">Role</label>
                    <select id="roleSelect">
                        <option value="">Select Role</option>
                    </select>
                </div>
            </div>
            
            <!-- Single Question Mode -->
            <div id="singleQuestionSection">
                <div class="form-group">
                    <label for="questionText">Question Text *</label>
                    <textarea id="questionText" rows="4" required placeholder="Enter your question here..."></textarea>
                </div>
            </div>
            
            <!-- Batch Questions Mode -->
            <div id="batchQuestionsSection" style="display: none;">
                <div class="form-group">
                    <label for="batchQuestionsText">Questions (one per line) *</label>
                    <textarea id="batchQuestionsText" rows="8" required placeholder="Enter multiple questions, one per line:

Example:
What is React JS?
Explain useState hook.
What are React components?
How does virtual DOM work?"></textarea>
                    <small>Enter each question on a new line. All questions will use the same Category, Company, and Role selected above.</small>
                </div>
                <div class="batch-preview" id="batchPreview" style="display: none; margin-top: 15px;">
                    <h4 style="margin-bottom: 10px; color: #475569;">Preview (<span id="questionCount">0</span> questions)</h4>
                    <div id="previewList" style="max-height: 200px; overflow-y: auto; background: #f8fafc; padding: 10px; border-radius: 6px; border: 1px solid #e2e8f0;"></div>
                </div>
            </div>
            
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeModal('questionModal')">Cancel</button>
                <button type="submit" class="btn btn-primary" id="submitBtn">Save Question</button>
            </div>
        </form>
    </div>
</div>

    <!-- Answer Modal -->
    <div id="answerModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('answerModal')">&times;</span>
            <h3 id="answerModalTitle">Add New Answer</h3>
            <form id="answerForm">
                <input type="hidden" id="answerId">
                <div class="form-group">
                    <label for="answerText">Answer Text *</label>
                    <textarea id="answerText" rows="6" required></textarea>
                    <small>You can add multiple answers to a question</small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('answerModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Answer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Category Modal -->
    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('categoryModal')">&times;</span>
            <h3 id="categoryModalTitle">Add New Category</h3>
            <form id="categoryForm">
                <input type="hidden" id="categoryId">
                <div class="form-group">
                    <label for="modalCategoryName">Category Name *</label>
                    <input type="text" id="modalCategoryName" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('categoryModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Category</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Company Modal -->
    <div id="companyModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('companyModal')">&times;</span>
            <h3 id="companyModalTitle">Add New Company</h3>
            <form id="companyForm">
                <input type="hidden" id="companyId">
                <div class="form-group">
                    <label for="modalCompanyName">Company Name *</label>
                    <input type="text" id="modalCompanyName" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('companyModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Company</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Role Modal -->
    <div id="roleModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('roleModal')">&times;</span>
            <h3 id="roleModalTitle">Add New Role</h3>
            <form id="roleForm">
                <input type="hidden" id="roleId">
                <div class="form-group">
                    <label for="modalRoleTitle">Role Title *</label>
                    <input type="text" id="modalRoleTitle" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('roleModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Role</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Session Modal -->
    <div id="sessionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('sessionModal')">&times;</span>
            <h3 id="sessionModalTitle">Create Practice Session</h3>
            <form id="sessionForm">
                <input type="hidden" id="sessionId">
                <div class="form-group">
                    <label for="modalSessionName">Session Name *</label>
                    <input type="text" id="modalSessionName" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="modalSessionCompany">Company</label>
                        <select id="modalSessionCompany">
                            <option value="">Select Company</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="modalSessionRole">Role</label>
                        <select id="modalSessionRole">
                            <option value="">Select Role</option>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('sessionModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Session</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <h3 id="confirmTitle">Confirm Action</h3>
            <p id="confirmMessage"></p>
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="closeModal('confirmModal')">Cancel</button>
                <button class="btn btn-danger" id="confirmActionBtn">Confirm</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>